<div class="row" *ngIf="!stats || !orderStats || !deliveryDays">
  <div class="col-12">
    <h3>Loading MB Dashboard...</h3>
  </div>
</div>

<div
  class="row"
  *ngIf="stats && orderStats && deliveryDays && subscriptionCoffeeTypeCounter"
>
  <div class="col-12">
    <mat-card class="product-card">
      <mat-card-content>
        <h2>
          Neste levering: {{ deliveryDays[0].date | date: "EEEE d. MMMM" }} -
          {{ resolveDeliveryTypeString(deliveryDays[0].type) }} -
          {{ deliveryDays[0].quantities.totalWeight }}kg
        </h2>

        <h4>Bedrifts-bestillinger</h4>
        <div>
          <small>
            P.t. vises ikke fordeling av kaffe-typ, allt blir <em>ANY</em>
          </small>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th>Kaffe</th>
              <th>250g</th>
              <th>500g</th>
              <th>Kilo</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let day of deliveryDays.slice(0, 1)">
              <tr>
                <td>ANY</td>
                <td>{{ day.quantities._250s_company.totalCount }}</td>
                <td>{{ day.quantities._500s.totalCount }}</td>
                <td>{{ day.quantities._1000s.totalCount }}</td>
              </tr>
            </ng-container>
          </tbody>
        </table>

        <h4>Fordeling av kaffe for aboabo</h4>
        <div>
          <small>
            Viser fordeling for abos og gabos. Viser antall poser (250g) / kg.
          </small>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th></th>
              <th>Totalt</th>
              <th>Kaffe 1</th>
              <th>Kaffe 2</th>
              <th>Kaffe 3</th>
              <th>Kaffe 4</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Stor-abo</td>
              <td>{{ resolveCoffeTypeCountString("bigAbo", "total") }}</td>
              <td>{{ resolveCoffeTypeCountString("bigAbo", "coffee1") }}</td>
              <td>{{ resolveCoffeTypeCountString("bigAbo", "coffee2") }}</td>
              <td>{{ resolveCoffeTypeCountString("bigAbo", "coffee3") }}</td>
              <td>{{ resolveCoffeTypeCountString("bigAbo", "coffee4") }}</td>
            </tr>
            <tr>
              <td>Lill-abo</td>
              <td>{{ resolveCoffeTypeCountString("smallAbo", "total") }}</td>
              <td>{{ resolveCoffeTypeCountString("smallAbo", "coffee1") }}</td>
              <td>{{ resolveCoffeTypeCountString("smallAbo", "coffee2") }}</td>
              <td>{{ resolveCoffeTypeCountString("smallAbo", "coffee3") }}</td>
              <td>{{ resolveCoffeTypeCountString("smallAbo", "coffee4") }}</td>
            </tr>
          </tbody>
        </table>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="col-12">
    <mat-card class="product-card">
      <mat-card-header>
        <mat-card-title>#aboabo</mat-card-title>
      </mat-card-header>
      <h1>
        {{ stats.subscriptionActiveCount + stats.giftSubscriptionCount }} aktive
        abos
      </h1>

      <p>
        {{
          stats.subscriptionFortnightlyCount +
            stats.giftSubscriptionFortnightlyCount
        }}
        annenhver uke,
        {{
          stats.subscriptionMonthlyCount + stats.giftSubscriptionMonthlyCount
        }}
        m책nedlig
        <br />
        {{ stats.giftSubscriptionCount }} gabos
      </p>

      <mat-card-content>
        <!-- <p>
          Antall poser 1. tirsdag:
          <strong>
            {{
              stats.subsciptionsBagsPerMonthlyCount +
                stats.subsciptionsBagsPerFortnightlyCount
            }}
          </strong>
          <br />

          Antall poser 3. tirsdag:
          <strong> {{ stats.subsciptionsBagsPerFortnightlyCount }} </strong>
        </p> -->

        <!-- <p>
          Antall poser totalt per m책ned:
          <strong>{{ stats.subsciptionsBagsPerMonthCount }}</strong> <br />

          Gyldne abosnittet:
          <strong>{{
            stats.subsciptionsBagsPerMonthCount /
              (stats.subscriptionActiveCount + stats.giftSubscriptionCount)
              | number: "1.1-1"
          }}</strong>
          <br />

          Abos p책 pause: {{ stats.subscriptionOnHoldCount }} <br />

          Gabos: {{ stats.giftSubscriptionCount }}
        </p> -->

        <table class="table">
          <thead>
            <tr>
              <th colspan="7" class="full-col">
                Antall poser per utsendelse
              </th>
            </tr>
            <tr>
              <th>1</th>
              <th>2</th>
              <th>3</th>
              <th>4</th>
              <th>5</th>
              <th>6</th>
              <th>7</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td colspan="7" class="full-col">
                Annenhver uke ({{ stats.subsciptionsBagsPerFortnightlyCount }}
                poser)
              </td>
            </tr>
            <tr>
              <td>{{ stats.bagCounter.fortnightly.one }}</td>
              <td>{{ stats.bagCounter.fortnightly.two }}</td>
              <td>{{ stats.bagCounter.fortnightly.three }}</td>
              <td>{{ stats.bagCounter.fortnightly.four }}</td>
              <td>{{ stats.bagCounter.fortnightly.five }}</td>
              <td>{{ stats.bagCounter.fortnightly.six }}</td>
              <td>{{ stats.bagCounter.fortnightly.seven }}</td>
            </tr>
            <tr>
              <td colspan="7" class="full-col">
                M책nedlig ({{ stats.subsciptionsBagsPerMonthlyCount }} poser)
              </td>
            </tr>
            <tr>
              <td>{{ stats.bagCounter.monthly.one }}</td>
              <td>{{ stats.bagCounter.monthly.two }}</td>
              <td>{{ stats.bagCounter.monthly.three }}</td>
              <td>{{ stats.bagCounter.monthly.four }}</td>
              <td>{{ stats.bagCounter.monthly.five }}</td>
              <td>{{ stats.bagCounter.monthly.six }}</td>
              <td>{{ stats.bagCounter.monthly.seven }}</td>
            </tr>
            <tr>
              <td colspan="7" class="full-col">
                Totalt ({{
                  stats.subsciptionsBagsPerFortnightlyCount +
                    stats.subsciptionsBagsPerMonthlyCount
                }}
                poser)
              </td>
            </tr>
            <tr>
              <td>
                {{
                  stats.bagCounter.fortnightly.one +
                    stats.bagCounter.monthly.one
                }}
              </td>
              <td>
                {{
                  stats.bagCounter.fortnightly.two +
                    stats.bagCounter.monthly.two
                }}
              </td>
              <td>
                {{
                  stats.bagCounter.fortnightly.three +
                    stats.bagCounter.monthly.three
                }}
              </td>
              <td>
                {{
                  stats.bagCounter.fortnightly.four +
                    stats.bagCounter.monthly.four
                }}
              </td>
              <td>
                {{
                  stats.bagCounter.fortnightly.five +
                    stats.bagCounter.monthly.five
                }}
              </td>
              <td>
                {{
                  stats.bagCounter.fortnightly.six +
                    stats.bagCounter.monthly.six
                }}
              </td>
              <td>
                {{
                  stats.bagCounter.fortnightly.seven +
                    stats.bagCounter.monthly.seven
                }}
              </td>
            </tr>
          </tbody>
        </table>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="col-12 col-lg-6">
    <mat-card class="product-card">
      <mat-card-header>
        <mat-card-title>#aktive kaffe</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <ng-container *ngFor="let coffee of coffees">
          <div>
            {{ coffee.code }} - {{ coffee.name }} - {{ coffee.country }}
          </div>
        </ng-container>
        <div><a [routerLink]="['/coffees']">Endre</a></div>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="col-12 col-lg-6">
    <mat-card class="product-card">
      <mat-card-header>
        <mat-card-title>#kommende leveringer</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <table class="table">
          <thead>
            <tr>
              <th>Dato</th>
              <th>Type</th>
              <th>Kg (abos, estimert)</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let day of deliveryDays.slice(1)">
              <tr class="future_delivery">
                <td>{{ day.date | date: "EEEE d. MMMM" }}</td>
                <td>{{ resolveDeliveryTypeString(day.type) }}</td>
                <td>{{ day.quantities.totalWeight }}kg</td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="col-12 col-lg-6">
    <mat-card class="product-card">
      <mat-card-header>
        <mat-card-title>#privat (woo)</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>
          Processing: <strong>{{ stats.orderProcessingCount }}</strong> <br />
          On hold: <strong>{{ stats.orderOnHoldCount }}</strong> <br />
          Pending payment:
          <strong>{{ stats.orderPendingPaymentCount }}</strong> <br />
        </p>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="col-12  col-lg-6">
    <mat-card class="product-card">
      <mat-card-header>
        <mat-card-title>#bedrift (backoffice)</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>
          Processing: <strong>{{ orderStats.activeOrderCount }}</strong> <br />
        </p>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="col-12">
    <p>Data from Woo last updated {{ statsLastUpdated | date: "short" }}</p>
    <p>
      <button mat-raised-button (click)="updateStats()" [disabled]="isUpdating">
        Update now
      </button>
    </p>
  </div>
</div>
